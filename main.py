import time
from pip._internal.cli.main import main

# todo убрать когда-то
while True:
    try:
        import lxml

        break
    except ModuleNotFoundError:
        main(["install", "-U", "lxml>=5.3.0"])
while True:
    try:
        import bcrypt

        break
    except ModuleNotFoundError:
        main(["install", "-U", "bcrypt>=4.2.0"])
import Utils.cardinal_tools
import Utils.config_loader as cfg_loader
from first_setup import first_setup
from colorama import Fore, Style
from Utils.logger import LOGGER_CONFIG
import logging.config
import colorama
import sys
import os
from cardinal import Cardinal
import Utils.exceptions as excs
from locales.localizer import Localizer

logo = """                  [38;2;19;121;18m█[38;2;39;240;35m█[38;2;38;233;35m█[38;2;18;108;16m█                  [0m
                [38;2;13;80;12m█[38;2;33;199;30m█[38;2;42;255;37m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;42;254;38m█[38;2;32;190;28m█[38;2;11;69;11m█                [0m
              [38;2;8;53;8m█[38;2;29;174;26m█[38;2;42;254;38m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;38;233;34m█[38;2;40;241;35m█[38;2;43;255;38m█[38;2;43;255;38m█[38;2;41;251;37m█[38;2;27;164;24m█[38;2;8;46;7m█              [0m
            [38;2;5;30;4m█[38;2;23;142;21m█[38;2;39;241;37m█[38;2;43;255;40m█[38;2;42;255;39m█[38;2;40;247;37m█[38;2;25;154;23m█[38;2;6;37;5m█[38;2;9;55;8m█[38;2;30;177;26m█[38;2;41;254;38m█[38;2;42;255;39m█[38;2;44;255;39m█[38;2;39;235;35m█[38;2;22;131;20m█[38;2;4;24;4m█            [0m
           [38;2;19;108;16m█[38;2;37;222;33m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;42;255;39m█[38;2;31;188;28m█[38;2;10;65;9m█    [38;2;13;81;12m█[38;2;34;201;30m█[38;2;43;255;38m█[38;2;43;255;38m█[38;2;43;255;39m█[38;2;35;214;33m█[38;2;16;98;15m█           [0m
         [38;2;13;74;12m█[38;2;33;198;30m█[38;2;42;255;39m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;36;215;32m█[38;2;16;96;14m█        [38;2;19;112;17m█[38;2;37;224;34m█[38;2;43;255;38m█[38;2;43;255;38m█[38;2;43;255;39m█[38;2;31;188;28m█[38;2;11;66;10m█         [0m
       [38;2;8;47;7m█[38;2;28;168;25m█[38;2;42;252;38m█[38;2;43;255;39m█[38;2;43;255;40m█[38;2;40;236;35m█[38;2;22;133;20m█[38;2;4;24;4m█          [38;2;5;31;5m█[38;2;24;143;21m█[38;2;40;241;36m█[38;2;43;255;39m█[38;2;42;255;38m█[38;2;41;248;37m█[38;2;26;157;23m█[38;2;7;40;6m█       [0m
     [38;2;4;25;4m█[38;2;22;132;20m█[38;2;40;236;36m█[38;2;44;255;39m█[38;2;43;255;38m█[38;2;42;252;38m█[38;2;28;167;25m█[38;2;8;47;7m█              [38;2;9;54;8m█[38;2;29;174;26m█[38;2;41;254;37m█[38;2;42;255;38m█[38;2;43;255;39m█[38;2;37;230;34m█[38;2;19;122;18m█      [0m
    [38;2;16;98;14m█[38;2;36;215;33m█[38;2;43;255;38m█[38;2;43;255;38m█[38;2;43;255;39m█[38;2;33;198;30m█[38;2;12;76;11m█                  [38;2;13;82;12m█[38;2;33;203;29m█[38;2;42;255;37m█[38;2;41;255;37m█[38;2;42;255;39m█[38;2;34;207;33m█[38;2;15;87;14m█    [0m
   [38;2;25;152;22m█[38;2;43;255;39m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;37;218;32m█[38;2;17;105;16m█                      [38;2;18;112;16m█[38;2;35;224;33m█[38;2;41;255;38m█[38;2;43;255;40m█[38;2;44;255;40m█[38;2;23;135;21m█   [0m
  [38;2;11;69;10m█[38;2;40;250;36m█[38;2;40;255;36m█[38;2;41;255;37m█[38;2;42;255;37m█[38;2;31;187;28m█[38;2;7;40;6m█                      [38;2;8;48;7m█[38;2;32;198;30m█[38;2;42;255;40m█[38;2;44;255;41m█[38;2;45;255;40m█[38;2;42;245;38m█[38;2;10;55;8m█  [0m
  [38;2;31;193;28m█[38;2;42;255;37m█[38;2;41;255;37m█[38;2;42;255;38m█[38;2;42;255;37m█[38;2;42;255;38m█[38;2;39;235;35m█[38;2;22;129;20m█[38;2;4;22;3m█                  [38;2;4;27;4m█[38;2;23;137;21m█[38;2;39;240;37m█[38;2;43;255;40m█[38;2;44;255;41m█[38;2;44;253;41m█[38;2;44;255;40m█[38;2;45;255;41m█[38;2;31;178;28m█  [0m
 [38;2;16;98;15m█[38;2;42;254;39m█[38;2;43;255;38m█[38;2;28;177;25m█[38;2;15;92;13m█[38;2;35;209;31m█[38;2;43;255;39m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;35;211;32m█[38;2;15;91;13m█                [38;2;16;101;15m█[38;2;35;218;33m█[38;2;42;255;40m█[38;2;43;255;40m█[38;2;43;255;40m█[38;2;32;191;31m█[38;2;13;75;12m█[38;2;33;193;31m█[38;2;43;255;39m█[38;2;43;252;39m█[38;2;15;83;13m█ [0m
[38;2;4;24;4m█[38;2;37;216;35m█[38;2;43;255;40m█[38;2;40;242;37m█[38;2;8;51;7m█  [38;2;20;121;18m█[38;2;38;229;34m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;42;255;37m█[38;2;30;182;27m█[38;2;10;58;9m█            [38;2;11;67;10m█[38;2;31;191;28m█[38;2;41;255;39m█[38;2;42;255;39m█[38;2;44;255;40m█[38;2;37;219;34m█[38;2;18;102;16m█  [38;2;12;69;11m█[38;2;41;248;38m█[38;2;44;255;40m█[38;2;35;204;33m█ [0m
[38;2;26;148;23m█[38;2;44;255;41m█[38;2;44;254;41m█[38;2;22;132;20m█    [38;2;6;38;5m█[38;2;25;153;23m█[38;2;40;246;37m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;40;244;36m█[38;2;24;146;21m█[38;2;5;32;4m█        [38;2;7;43;6m█[38;2;26;159;25m█[38;2;41;249;38m█[38;2;42;255;39m█[38;2;42;255;40m█[38;2;40;240;37m█[38;2;24;139;21m█[38;2;4;28;4m█    [38;2;24;149;24m█[38;2;42;255;42m█[38;2;43;255;41m█[38;2;23;129;19m█[0m
[38;2;44;255;40m█[38;2;44;255;40m█[38;2;42;252;39m█[38;2;18;111;17m█      [38;2;10;61;9m█[38;2;30;185;28m█[38;2;41;255;39m█[38;2;42;255;39m█[38;2;43;255;39m█[38;2;37;223;34m█[38;2;18;110;17m█     [38;2;4;24;4m█[38;2;21;128;20m█[38;2;38;233;36m█[38;2;42;255;41m█[38;2;42;255;39m█[38;2;42;254;40m█[38;2;29;176;27m█[38;2;9;53;8m█      [38;2;21;126;21m█[38;2;43;254;42m█[38;2;45;255;39m█[38;2;43;250;34m█[0m
[38;2;39;228;37m█[38;2;44;255;41m█[38;2;44;255;39m█[38;2;43;253;39m█[38;2;31;183;28m█[38;2;10;60;9m█      [38;2;15;92;14m█[38;2;35;212;33m█[38;2;43;255;39m█[38;2;42;255;39m█[38;2;41;255;39m█[38;2;32;198;30m█[38;2;13;75;12m█  [38;2;16;99;15m█[38;2;36;214;34m█[38;2;43;255;40m█[38;2;43;255;40m█[38;2;44;255;42m█[38;2;34;207;32m█[38;2;14;85;14m█      [38;2;11;69;11m█[38;2;33;192;30m█[38;2;43;254;42m█[38;2;43;255;39m█[38;2;45;255;39m█[38;2;33;214;31m█[0m
[38;2;6;34;6m█[38;2;25;145;23m█[38;2;42;244;38m█[38;2;43;255;38m█[38;2;44;255;39m█[38;2;43;245;37m█[38;2;26;150;24m█[38;2;6;34;5m█     [38;2;4;22;4m█[38;2;22;129;20m█[38;2;39;235;37m█[38;2;42;255;40m█[38;2;42;255;39m█[38;2;42;252;38m█[38;2;28;172;26m█[38;2;32;191;29m█[38;2;43;255;41m█[38;2;43;255;41m█[38;2;43;255;41m█[38;2;38;230;37m█[38;2;21;122;20m█      [38;2;8;42;7m█[38;2;28;160;24m█[38;2;40;250;37m█[38;2;43;255;40m█[38;2;43;255;41m█[38;2;43;239;36m█[38;2;24;136;21m█[38;2;4;27;4m█[0m
  [38;2;11;63;10m█[38;2;39;226;34m█[38;2;44;255;39m█[38;2;45;255;40m█[38;2;45;255;41m█[38;2;38;226;35m█[38;2;19;116;18m█      [38;2;8;45;7m█[38;2;28;166;26m█[38;2;41;251;38m█[38;2;42;255;39m█[38;2;43;255;40m█[38;2;43;255;40m█[38;2;43;255;39m█[38;2;42;248;39m█[38;2;27;159;25m█[38;2;7;40;6m█     [38;2;4;21;4m█[38;2;22;126;20m█[38;2;39;232;35m█[38;2;44;255;38m█[38;2;41;255;37m█[38;2;41;255;38m█[38;2;35;216;34m█[38;2;10;54;8m█  [0m
   [38;2;33;190;30m█[38;2;44;255;40m█[38;2;43;254;39m█[38;2;43;255;40m█[38;2;44;255;39m█[38;2;44;255;40m█[38;2;35;202;30m█[38;2;13;81;12m█      [38;2;14;86;14m█[38;2;41;244;38m█[38;2;42;255;40m█[38;2;42;255;40m█[38;2;39;238;36m█[38;2;12;73;11m█      [38;2;16;92;14m█[38;2;37;210;32m█[38;2;44;255;40m█[38;2;43;255;40m█[38;2;43;255;38m█[38;2;40;254;36m█[38;2;43;255;38m█[38;2;28;173;27m█   [0m
   [38;2;33;193;28m█[38;2;45;255;41m█[38;2;37;214;33m█[38;2;22;128;20m█[38;2;39;228;33m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;43;254;39m█[38;2;30;174;26m█[38;2;9;52;7m█    [38;2;16;96;15m█[38;2;43;251;39m█[38;2;42;255;39m█[38;2;42;255;40m█[38;2;42;247;39m█[38;2;13;79;12m█    [38;2;10;61;10m█[38;2;31;184;29m█[38;2;44;255;39m█[38;2;45;255;39m█[38;2;45;255;40m█[38;2;37;222;34m█[38;2;21;126;18m█[38;2;38;235;34m█[38;2;43;255;40m█[38;2;30;176;27m█   [0m
   [38;2;34;193;29m█[38;2;46;255;42m█[38;2;34;204;33m█ [38;2;7;37;5m█[38;2;25;154;23m█[38;2;42;247;35m█[38;2;43;255;40m█[38;2;44;255;40m█[38;2;41;239;38m█[38;2;24;139;21m█[38;2;4;28;4m█ [38;2;4;24;4m█[38;2;37;221;36m█[38;2;42;255;40m█[38;2;41;255;39m█[38;2;42;255;39m█[38;2;43;255;41m█[38;2;35;210;33m█  [38;2;6;34;5m█[38;2;25;150;24m█[38;2;41;245;39m█[38;2;44;255;41m█[38;2;44;255;40m█[38;2;42;245;37m█[38;2;25;148;23m█[38;2;5;31;5m█ [38;2;36;224;32m█[38;2;43;255;41m█[38;2;31;176;28m█   [0m
   [38;2;35;193;33m█[38;2;47;255;43m█[38;2;34;206;34m█   [38;2;11;64;9m█[38;2;31;187;27m█[38;2;44;255;40m█[38;2;44;255;41m█[38;2;44;255;41m█[38;2;37;220;34m█[38;2;17;99;15m█[38;2;24;143;22m█[38;2;43;255;41m█[38;2;42;255;39m█[38;2;41;255;39m█[38;2;42;255;39m█[38;2;42;255;40m█[38;2;43;255;40m█[38;2;21;130;19m█[38;2;18;109;16m█[38;2;37;226;35m█[38;2;42;255;40m█[38;2;42;255;40m█[38;2;42;255;40m█[38;2;32;186;29m█[38;2;10;61;9m█   [38;2;36;221;34m█[38;2;45;255;42m█[38;2;30;176;27m█   [0m
   [38;2;33;193;31m█[38;2;43;255;42m█[38;2;34;206;33m█     [38;2;17;94;15m█[38;2;36;213;34m█[38;2;43;255;40m█[38;2;43;255;40m█[38;2;42;255;39m█[38;2;41;254;38m█[38;2;41;255;38m█[38;2;41;255;39m█[38;2;41;255;38m█[38;2;41;255;38m█[38;2;41;255;39m█[38;2;41;255;38m█[38;2;40;254;37m█[38;2;41;255;37m█[38;2;41;255;38m█[38;2;41;255;38m█[38;2;34;213;32m█[38;2;15;94;14m█     [38;2;37;221;34m█[38;2;45;255;42m█[38;2;30;176;28m█   [0m
   [38;2;31;193;29m█[38;2;42;255;41m█[38;2;34;206;31m█      [38;2;4;22;4m█[38;2;21;128;20m█[38;2;38;233;35m█[38;2;42;255;38m█[38;2;40;255;38m█[38;2;39;251;37m█[38;2;28;186;27m█[38;2;40;251;36m█[38;2;39;248;36m█[38;2;30;191;28m█[38;2;41;255;37m█[38;2;41;255;37m█[38;2;42;255;38m█[38;2;37;231;33m█[38;2;20;128;18m█[38;2;3;22;3m█      [38;2;37;221;33m█[38;2;44;255;40m█[38;2;29;176;28m█   [0m
   [38;2;33;193;29m█[38;2;45;255;40m█[38;2;35;206;31m█        [38;2;6;43;6m█[38;2;26;162;24m█[38;2;39;242;36m█[38;2;27;171;24m█[38;2;15;95;14m█[38;2;41;255;37m█[38;2;41;250;36m█[38;2;13;83;12m█[38;2;29;181;26m█[38;2;39;241;35m█[38;2;24;155;22m█[38;2;6;41;6m█        [38;2;37;221;33m█[38;2;44;255;39m█[38;2;29;176;27m█   [0m
   [38;2;34;193;30m█[38;2;46;255;41m█[38;2;35;206;32m█          [38;2;6;34;5m█ [38;2;14;87;13m█[38;2;43;255;38m█[38;2;43;253;38m█[38;2;12;69;11m█ [38;2;6;34;5m█          [38;2;37;221;33m█[38;2;44;255;39m█[38;2;29;176;26m█   [0m
   [38;2;33;193;33m█[38;2;45;255;43m█[38;2;37;205;33m█            [38;2;15;89;14m█[38;2;43;255;39m█[38;2;42;253;38m█[38;2;12;72;11m█            [38;2;36;221;32m█[38;2;44;255;39m█[38;2;29;176;26m█   [0m
   [38;2;34;194;31m█[38;2;45;255;41m█[38;2;37;210;32m█            [38;2;15;89;14m█[38;2;43;255;39m█[38;2;42;253;37m█[38;2;12;72;11m█     [38;2;7;43;6m█      [38;2;37;224;32m█[38;2;43;255;39m█[38;2;29;177;26m█   [0m
   [38;2;33;190;31m█[38;2;45;255;40m█[38;2;42;250;37m█[38;2;27;161;24m█[38;2;7;44;6m█          [38;2;15;89;13m█[38;2;43;255;38m█[38;2;42;253;37m█[38;2;12;72;11m█   [38;2;9;50;7m█[38;2;29;170;25m█[38;2;43;245;37m█[38;2;31;182;28m█   [38;2;8;52;7m█[38;2;29;174;26m█[38;2;42;252;37m█[38;2;43;255;39m█[38;2;28;171;26m█   [0m
   [38;2;23;129;21m█[38;2;44;254;39m█[38;2;45;255;39m█[38;2;45;255;40m█[38;2;40;234;36m█[38;2;21;129;20m█[38;2;4;23;4m█        [38;2;15;89;13m█[38;2;42;255;39m█[38;2;42;253;38m█[38;2;12;72;10m█ [38;2;4;27;4m█[38;2;24;137;21m█[38;2;41;238;36m█[38;2;45;255;40m█[38;2;45;255;40m█[38;2;36;218;34m█ [38;2;5;28;4m█[38;2;23;139;21m█[38;2;39;239;35m█[38;2;43;255;39m█[38;2;43;255;38m█[38;2;43;252;38m█[38;2;18;113;17m█   [0m
    [38;2;14;83;12m█[38;2;35;203;32m█[38;2;44;255;40m█[38;2;43;255;41m█[38;2;42;255;40m█[38;2;35;213;32m█[38;2;15;95;13m█       [38;2;15;89;13m█[38;2;43;255;38m█[38;2;42;253;38m█[38;2;12;67;10m█[38;2;11;68;10m█[38;2;37;218;33m█[38;2;44;255;39m█[38;2;44;255;39m█[38;2;43;255;39m█[38;2;31;186;28m█[38;2;11;68;10m█[38;2;17;102;16m█[38;2;37;220;34m█[38;2;42;255;38m█[38;2;42;255;39m█[38;2;42;255;38m█[38;2;33;197;30m█[38;2;12;74;11m█    [0m
      [38;2;20;117;19m█[38;2;39;227;37m█[38;2;42;255;41m█[38;2;41;255;38m█[38;2;41;255;37m█[38;2;31;187;27m█[38;2;11;63;9m█     [38;2;15;89;14m█[38;2;43;255;38m█[38;2;42;252;38m█[38;2;12;71;10m█[38;2;29;171;26m█[38;2;46;255;41m█[38;2;44;255;39m█[38;2;36;214;32m█[38;2;17;101;15m█[38;2;13;78;11m█[38;2;32;187;28m█[38;2;43;255;39m█[38;2;42;255;39m█[38;2;43;255;38m█[38;2;37;221;34m█[38;2;18;107;16m█      [0m
       [38;2;6;35;6m█[38;2;25;149;23m█[38;2;40;244;36m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;41;246;37m█[38;2;25;153;23m█[38;2;6;36;5m█   [38;2;15;89;14m█[38;2;43;255;39m█[38;2;41;253;38m█[38;2;11;67;10m█[38;2;14;80;12m█[38;2;34;191;30m█[38;2;21;126;19m█[38;2;11;66;10m█[38;2;26;154;23m█[38;2;42;249;37m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;39;240;35m█[38;2;23;140;21m█[38;2;4;29;4m█       [0m
         [38;2;10;59;9m█[38;2;30;182;27m█[38;2;41;255;36m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;38;228;34m█[38;2;19;118;17m█  [38;2;15;88;13m█[38;2;42;255;39m█[38;2;42;253;38m█[38;2;12;70;10m█ [38;2;4;27;4m█[38;2;20;121;18m█[38;2;38;230;35m█[38;2;43;255;40m█[38;2;43;255;39m█[38;2;42;253;37m█[38;2;28;173;26m█[38;2;9;53;7m█         [0m
           [38;2;14;88;12m█[38;2;33;207;30m█[38;2;41;255;37m█[38;2;42;255;37m█[38;2;42;255;38m█[38;2;33;203;31m█[38;2;12;72;11m█[38;2;15;91;14m█[38;2;42;255;39m█[38;2;42;252;38m█[38;2;13;76;11m█[38;2;14;84;12m█[38;2;35;209;32m█[38;2;42;255;39m█[38;2;42;255;39m█[38;2;42;255;39m█[38;2;32;201;30m█[38;2;13;79;12m█           [0m
             [38;2;19;122;17m█[38;2;37;230;33m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;41;249;37m█[38;2;35;215;32m█[38;2;41;254;37m█[38;2;41;252;37m█[38;2;35;215;31m█[38;2;41;253;37m█[38;2;43;255;39m█[38;2;43;255;39m█[38;2;37;224;34m█[38;2;19;112;17m█             [0m
              [38;2;6;39;5m█[38;2;25;154;23m█[38;2;41;246;36m█[38;2;42;255;38m█[38;2;42;255;38m█[38;2;41;255;36m█[38;2;41;255;37m█[38;2;42;255;38m█[38;2;43;255;38m█[38;2;40;243;36m█[38;2;24;146;21m█[38;2;5;32;4m█              [0m
                [38;2;10;62;9m█[38;2;30;185;27m█[38;2;41;253;37m█[38;2;40;255;36m█[38;2;41;255;37m█[38;2;41;251;37m█[38;2;29;175;26m█[38;2;9;56;8m█                [0m
                  [38;2;16;99;14m█[38;2;36;229;33m█[38;2;35;224;33m█[38;2;14;89;13m█                  [0m"""

VERSION = "0.1.16.4"

Utils.cardinal_tools.set_console_title(f"FunPay Bot v{VERSION}")

if getattr(sys, 'frozen', False):
    os.chdir(os.path.dirname(sys.executable))
else:
    os.chdir(os.path.dirname(__file__))

folders = ["configs", "logs", "storage", "storage/cache", "storage/plugins", "storage/products", "plugins"]
for i in folders:
    if not os.path.exists(i):
        os.makedirs(i)

files = ["configs/auto_delivery.cfg", "configs/auto_response.cfg"]
for i in files:
    if not os.path.exists(i):
        with open(i, "w", encoding="utf-8") as f:
            ...

colorama.init()

logging.config.dictConfig(LOGGER_CONFIG)
logging.raiseExceptions = False
logger = logging.getLogger("main")
logger.debug("------------------------------------------------------------------")

print(f"{Style.RESET_ALL}{logo}")
print(f"{Fore.RED}{Style.BRIGHT}v{VERSION}{Style.RESET_ALL}\n")  # locale
print(f"{Fore.MAGENTA}{Style.BRIGHT}Официальные разработчики {Fore.BLUE}{Style.BRIGHT}Woopertail, @sidor0912{Style.RESET_ALL}")
print(f"{Fore.MAGENTA}{Style.BRIGHT} * GitHub (официального разработчика): {Fore.BLUE}{Style.BRIGHT}github.com/sidor0912/FunPayCardinal{Style.RESET_ALL}")
print(f"{Fore.MAGENTA}{Style.BRIGHT} * GitHub (наш адаптированный): {Fore.BLUE}{Style.BRIGHT}github.com/BOX-Hosting/FunPay{Style.RESET_ALL}")
print(f"{Fore.MAGENTA}{Style.BRIGHT} * Новости о обновлениях: {Fore.BLUE}{Style.BRIGHT}t.me/box_funpaybot")
print(f"{Fore.RED}{Style.BRIGHT}*Мы не стремимся навредить репутации Funpay Cardinal и их создателей. Мы оптимизировали код для нашего хостинга, убрав лишние элементы. Наш код безопасен и открыт на GitHub. Вы можете проверить его самостоятельно. Мы постоянно обновляем бота.")

if not os.path.exists("configs/_main.cfg"):
    first_setup()
    sys.exit()

if sys.platform == "linux" and os.getenv('FPC_IS_RUNNIG_AS_SERVICE', '0') == '1':
    import getpass

    pid = str(os.getpid())
    pidFile = open(f"/run/FunPayCardinal/{getpass.getuser()}/FunPayCardinal.pid", "w")
    pidFile.write(pid)
    pidFile.close()

    logger.info(f"$GREENPID файл создан, PID процесса: {pid}")  # locale

directory = 'plugins'
for filename in os.listdir(directory):
    if filename.endswith(".py"):  # Проверяем, что файл имеет расширение .py
        filepath = os.path.join(directory, filename)  # Получаем полный путь к файлу
        with open(filepath, 'r', encoding='utf-8') as file:
            data = file.read()  # Читаем содержимое файла
        # Заменяем подстроку
        if '"<i>Разработчик:</i> " + CREDITS' in data or " lot.stars " in data or " lot.seller " in data:
            data = data.replace('"<i>Разработчик:</i> " + CREDITS', '"sidor0912"') \
                .replace(" lot.stars ", " lot.seller.stars ") \
                .replace(" lot.seller ", " lot.seller.username ")
            # Сохраняем изменения обратно в файл
            with open(filepath, 'w', encoding='utf-8') as file:
                file.write(data)

try:
    logger.info("$MAGENTAЗагружаю конфиг _main.cfg...")  # locale
    MAIN_CFG = cfg_loader.load_main_config("configs/_main.cfg")
    localizer = Localizer(MAIN_CFG["Other"]["language"])
    _ = localizer.translate

    logger.info("$MAGENTAЗагружаю конфиг auto_response.cfg...")  # locale
    AR_CFG = cfg_loader.load_auto_response_config("configs/auto_response.cfg")
    RAW_AR_CFG = cfg_loader.load_raw_auto_response_config("configs/auto_response.cfg")

    logger.info("$MAGENTAЗагружаю конфиг auto_delivery.cfg...")  # locale
    AD_CFG = cfg_loader.load_auto_delivery_config("configs/auto_delivery.cfg")
except excs.ConfigParseError as e:
    logger.error(e)
    logger.error("Завершаю программу...")  # locale
    time.sleep(5)
    sys.exit()
except UnicodeDecodeError:
    logger.error("Произошла ошибка при расшифровке UTF-8. Убедитесь, что кодировка файла = UTF-8, "
                 "а формат конца строк = LF.")  # locale
    logger.error("Завершаю программу...")  # locale
    time.sleep(5)
    sys.exit()
except:
    logger.critical("Произошла непредвиденная ошибка.")  # locale
    logger.warning("TRACEBACK", exc_info=True)
    logger.error("Завершаю программу...")  # locale
    time.sleep(5)
    sys.exit()

localizer = Localizer(MAIN_CFG["Other"]["language"])

try:
    Cardinal(MAIN_CFG, AD_CFG, AR_CFG, RAW_AR_CFG, VERSION).init().run()
except KeyboardInterrupt:
    logger.info("Завершаю программу...")  # locale
    sys.exit()
except:
    logger.critical("При работе Кардинала произошла необработанная ошибка.")  # locale
    logger.warning("TRACEBACK", exc_info=True)
    logger.critical("Завершаю программу...")  # locale
    time.sleep(5)
    sys.exit()
